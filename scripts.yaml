##################
# ANDREW CONTROL #
##################

# Turn off master and common room things, arm security
home_empty:
  sequence:
    - service: homeassistant.turn_off
      data:
        entity_id: group.master_bedroom
    - service: homeassistant.turn_off
      data:
        entity_id: group.office
    - delay:
        seconds: 5
    - service: homeassistant.turn_on
      data:
        entity_id: input_boolean.security_status

# Turn on lights and disarm security
home_occupied:
  sequence:
    - service: homeassistant.turn_off
      data:
        entity_id: input_boolean.security_status
    - service: homeassistant.turn_on
      data:
        entity_id: group.master_bedroom_lamps
    - service: homeassistant.turn_on
      data:
        entity_id: group.office_lamps

############
# SECURITY #
############

security_disarm:
  sequence:
    - service: alarm_control_panel.alarm_disarm
      entity_id: alarm_control_panel.alexa_guard_7f9e9
    - service: alarm_control_panel.alarm_disarm
      entity_id: !secret alarm_panel_1
    - service: alarm_control_panel.alarm_disarm
      entity_id: !secret alarm_panel_2
    - service: notify.pushover
      data:
        message: Disarmed!

security_arm:
  sequence:
    - service: alarm_control_panel.alarm_arm_away
      entity_id: alarm_control_panel.alexa_guard_7f9e9
    - service: alarm_control_panel.alarm_arm_home
      entity_id: !secret alarm_panel_1
    - service: alarm_control_panel.alarm_arm_home
      entity_id: !secret alarm_panel_2
    - service: notify.pushover
      data:
        message: Armed!

##########
# SCENES #
##########

#Call scene to turn all lights in room on
master_bedroom_light_full:
  sequence:
    - service: scene.turn_on
      data:
        entity_id: scene.master_bedroom_light_full

#Call scene to dim lights
master_bedroom_light_dim:
  sequence:
    - service: scene.turn_on
      data:
        entity_id: scene.master_bedroom_light_dim
    - service: homeassistant.turn_on
      data:
        entity_id: group.master_bedroom_lamps
    - service: homeassistant.turn_off
      data:
        entity_id: light.master_bedroom

master_bedroom_bedtime:
  sequence:
    - service: script.appdaemon_ac_night
    - service: fan.turn_on
      data:
        entity_id: fan.master_bedroom_ceiling_fan_level
    - service: light.turn_off
      data:
        entity_id: light.master_bedroom
    - service: homeassistant.turn_off
      data:
        entity_id: group.master_bedroom_lamps
    - service: homeassistant.turn_off
      data:
        entity_id: switch.master_bathroom_light_switch

master_bedroom_wakeup:
  sequence:
    - service: script.appdaemon_ac_morning
    - service: fan.turn_off
      data:
        entity_id: fan.master_bedroom_ceiling_fan_level
    - service: light.turn_on
      data:
        entity_id: light.master_bedroom
    - delay: '00:00:01'
    - service: homeassistant.turn_on
      data:
        entity_id: group.master_bedroom_lamps
    - service: homeassistant.turn_on
      data:
        entity_id: switch.master_bathroom_light_switch

#########
# OTHER #
#########

copy:
  sequence:
    - service: shell_command.copy

appdaemon_ac_night:
  sequence:
    - service: rest_command.adjust_night

appdaemon_ac_morning:
  sequence:
    - service: rest_command.adjust_morning

too_cold:
  sequence:
    - service: climate.set_temperature
      data_template:
        entity_id: climate.thermostat
        temperature: '{{ float(states("sensor.thermostat_setpoint")) + 2 }}'

too_hot:
  sequence:
    - service: climate.set_temperature
      data_template:
        entity_id: climate.thermostat
        temperature: '{{ float(states("sensor.thermostat_setpoint")) - 2 }}'

panic:
  sequence:
    - service: notify.pushover
      data:
        message: "Help!"
        title: "Panic!!"
        data:
          priority: 2
          expire: 3600
          retry: 30

spotify_occusim:
  sequence:
    - service: media_player.select_source
      data:
        entity_id: media_player.spotify
        source: 'Everywhere'
    - service: media_player.volume_set
      data:
        entity_id: media_player.spotify
        volume_level: 0.6
    - service: media_player.media_play
      data:
        entity_id: media_player.spotify

turn_ac_off:
  sequence:
    - service: climate.turn_off
      data:
        entity_id: climate.thermostat

tv_change_input:
  sequence:
    - service: homeassistant.turn_on
      data:
        entity_id: switch.tv_remote_input
